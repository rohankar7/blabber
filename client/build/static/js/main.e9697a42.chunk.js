(this.webpackJsonpchat_app=this.webpackJsonpchat_app||[]).push([[0],{137:function(e,t){},139:function(e,t){},147:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),s=n(78),o=n.n(s),i=(n(89),n(20)),r=n(11),l=n(12),u=n.n(l),d=n(16),j=n(79),m=(n(91),n(148),n(93),j.a.initializeApp({apiKey:"AIzaSyDm3P9134lOT85QloQ3z62fwvm-Ky40WC4",authDomain:"demoproject-63717.firebaseapp.com",projectId:"demoproject-63717",storageBucket:"demoproject-63717.appspot.com",messagingSenderId:"60046397751",appId:"1:60046397751:web:9aa62545ced606b693cab2",measurementId:"G-4PTMK0ZZ1W"})),b=n(5),f=n(2),p=a.a.createContext(),h=function(e){var t=e.children,n=Object(c.useState)(null),a=Object(b.a)(n,2),s=a[0],o=a[1];return Object(c.useEffect)((function(){m.auth().onAuthStateChanged((function(e){o(e)}))}),[]),Object(f.jsx)(p.Provider,{value:{currentUser:s},children:t})},g=(n(44),null),O=Object(r.g)((function(e){var t=e.history,n=Object(c.useContext)(p).currentUser,a=function(){document.getElementById("error").innerHTML=""},s=Object(c.useCallback)(function(){var e=Object(d.a)(u.a.mark((function e(n){var c,a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),c=n.target.elements,a=c.email,s=c.password,e.next=4,m.auth().signInWithEmailAndPassword(a.value,s.value).then((function(){if(m.auth().onAuthStateChanged((function(e){null!==e&&(g=e.emailVerified)})),!0===g)return t.push("/main"),console.log("Login - Email Verified:",g),Object(f.jsx)(r.a,{uid:m.auth().currentUser.uid,to:"/main"});t.push("/manage-user")})).catch((function(e){var t=document.getElementById("error");switch(e.code){case"auth/user-not-found":t.innerHTML="User not found";break;case"auth/wrong-password":t.innerHTML="Wrong Password";break;case"auth/invalid-email":t.innerHTML="Invalid Email";break;default:console.log(e.message)}null!==document.getElementById("m")&&(document.getElementById("m").value=""),null!==document.getElementById("p")&&(document.getElementById("p").value=null)}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);return Object(c.useEffect)((function(){console.log("LOGIN")}),[]),(m.auth().currentUser||g||null===n)&&null!==m.auth().currentUser?!0===m.auth().currentUser.emailVerified?Object(f.jsx)(r.a,{uid:m.auth().currentUser.uid,to:"/main"}):Object(f.jsx)(r.a,{to:"/manage-user"}):Object(f.jsx)("div",{className:"Login",children:Object(f.jsxs)("form",{onSubmit:s,children:[Object(f.jsx)("h1",{children:"LOGIN"}),Object(f.jsx)("div",{id:"error",style:{paddingBottom:"2vh",color:"darkgreen"}}),Object(f.jsx)("div",{className:"input_div",children:Object(f.jsx)("input",{name:"email",type:"email",placeholder:"Email",autoComplete:"off",id:"m",onClick:a})}),Object(f.jsx)("div",{className:"input_div",children:Object(f.jsx)("input",{type:"password",name:"password",placeholder:"Password",id:"p",onClick:a})}),Object(f.jsx)("button",{className:"uiButtons",type:"submit",children:"Login"}),Object(f.jsxs)("div",{className:"link",children:["Forgot your password?\xa0",Object(f.jsx)(i.b,{to:{pathname:"/manage-user",type:"resetPassword"},children:"Reset"})]}),Object(f.jsxs)("div",{className:"link",children:["Don't have an account?\xa0",Object(f.jsx)(i.b,{to:"/signup",children:"Signup"})]})]})})})),v=Object(r.g)((function(e){var t=e.history,n=function(){document.getElementById("error").innerHTML=""},a=Object(c.useCallback)(function(){var e=Object(d.a)(u.a.mark((function e(n){var c,a,s,o,i,r,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),c=n.target.elements,a=c.userName,s=c.email,o=c.password,i=c.confirmPassword,r=null,i.value!==o.value||""===a.value){e.next=8;break}return e.next=6,m.auth().createUserWithEmailAndPassword(s.value,o.value).then((function(){m.auth().onAuthStateChanged((function(e){r=e.emailVerified,e.sendEmailVerification().then((function(){console.log("Email Verification Sent")})).catch((function(e){console.log("ErrorCode: ".concat(e.code,", ErrorMessage: ").concat(e.message))})),m.database().ref("users/"+e.uid).set({uid:e.uid,uname:a.value}),m.storage().ref("users").child("".concat(e.uid,"/profile.jpg")).put("Default Profile").then((function(){console.log("Successfully Put Message in place of image")}))})),!0===r?t.push("/main"):t.push("/manage-user")})).catch((function(e){var t=document.getElementById("error");switch(e.code){case"auth/user-not-found":t.innerHTML="User not found";break;case"auth/wrong-password":t.innerHTML="Wrong Password";break;case"auth/invalid-email":t.innerHTML="Invalid Email";break;case"auth/email-already-in-use":t.innerHTML="Email already in use";break;case"auth/weak-password":t.innerHTML="Password must be at least 6 characters";break;default:console.log(e.message)}document.getElementById("u").value="",document.getElementById("m").value="",document.getElementById("p").value=null,document.getElementById("cp").value=null}));case 6:e.next=14;break;case 8:l=document.getElementById("error"),""===a.value?l.innerHTML="Invalid Username":l.innerHTML="Passwords don't match",document.getElementById("u").value="",document.getElementById("m").value="",document.getElementById("p").value=null,document.getElementById("cp").value=null;case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t]);return Object(f.jsx)("div",{className:"Signup",id:"signUp",children:Object(f.jsxs)("form",{onSubmit:a,children:[Object(f.jsx)("h1",{children:"SIGN\xa0UP"}),Object(f.jsx)("div",{id:"error",style:{paddingBottom:"2vh",color:"darkgreen"}}),Object(f.jsx)("div",{className:"input_div",children:Object(f.jsx)("input",{type:"text",placeholder:"User Name",autoComplete:"off",name:"userName",id:"u",onClick:n})}),Object(f.jsx)("div",{className:"input_div",children:Object(f.jsx)("input",{type:"email",placeholder:"Email",autoComplete:"off",autofill:"off",name:"email",id:"m",onClick:n})}),Object(f.jsx)("div",{className:"input_div",children:Object(f.jsx)("input",{type:"password",placeholder:"Password",name:"password",id:"p",onClick:n})}),Object(f.jsx)("div",{className:"input_div",children:Object(f.jsx)("input",{type:"password",placeholder:"Confirm Password",name:"confirmPassword",id:"cp",onClick:n})}),Object(f.jsx)("button",{className:"uiButtons",type:"submit",children:"Sign Up"}),Object(f.jsxs)("div",{className:"link",children:["Already have an account?\xa0",Object(f.jsx)(i.b,{to:"/login",children:"Login"})]})]})})})),x=function(){return Object(c.useEffect)((function(){}),[]),Object(f.jsxs)("div",{className:"Home",children:[Object(f.jsx)("div",{children:Object(f.jsxs)("ul",{className:"navUl",style:{listStyleType:"none"},children:[Object(f.jsx)("li",{className:"navItems",style:{width:"80%",textAlign:"left"},children:"HOME"}),Object(f.jsxs)("div",{className:"navBar",children:[Object(f.jsx)("li",{className:"navItems",id:"loginNav",children:Object(f.jsx)(i.b,{to:"/login",tabIndex:"0",style:{textDecoration:"none",padding:"2vh",borderRadius:"5px",color:"black"},children:"Login"})}),Object(f.jsx)("li",{className:"navItems",children:Object(f.jsx)(i.b,{to:"/signup",tabIndex:"1",style:{textDecoration:"none",padding:"2vh",borderRadius:"5px",color:"#000"},children:"Sign Up"})})]})]})}),Object(f.jsxs)("div",{className:"Back",children:[Object(f.jsxs)("div",{className:"Title",children:["Welcome to one of the best",Object(f.jsx)("br",{})," Chat communities online"]}),Object(f.jsx)("img",{src:"Assets/chat.png",alt:"chatImage"})]})]})},y=(n(54),n(28)),N=n.p+"static/media/profile.8ae99660.jpg",k=function(e){var t=Object(c.useState)(""),n=Object(b.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),i=Object(b.a)(o,2),r=i[0],l=i[1],u=Object(c.useState)(""),d=Object(b.a)(u,2),j=d[0],h=d[1],g=document.querySelectorAll("img"),O=Object(c.useContext)(p).currentUser;g.forEach((function(e){return e.draggable=!1})),m.database().ref("users/".concat(e.uid,"/contacts/").concat(O.uid,"/lastMessage")).on("child_changed",(function(e){h(e.val())})),m.database().ref(".info/connected").on("value",(function(e){console.log(e.val())})),Object(c.useEffect)((function(){e.sendBackData(!1),void 0!==e.lastMessage?h(e.lastMessage.lastMessage.lastMessage):h("")}),[e,O]),m.auth().onAuthStateChanged((function(t){t&&m.storage().ref("users/".concat(e.uid,"/profile.jpg")).getMetadata().then((function(t){"image/jpg"===t.contentType||"image/jpeg"===t.contentType||"image/png"===t.contentType?m.storage().ref("users/".concat(e.uid,"/profile.jpg")).getDownloadURL().then((function(e){s(e)})):s(N)})),l(e.uname)}));return Object(f.jsxs)("div",{className:"Contact",onClick:function(){e.getClickedContact(e.uid),e.getContactPic(a),e.getContactName(e.uname)},children:[Object(f.jsx)("div",{className:"section1",children:Object(f.jsx)("img",{className:"profileImages",src:a,alt:""})}),Object(f.jsxs)("div",{className:"section2",children:[Object(f.jsx)("h3",{children:r}),Object(f.jsx)("span",{children:j})]})]})},w=function(e){var t=Object(c.useState)(""),n=Object(b.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(!1),i=Object(b.a)(o,2),r=i[0],l=i[1],u=Object(c.useState)(!1),d=Object(b.a)(u,2),j=d[0],h=d[1],g=Object(c.useState)(null),O=Object(b.a)(g,2),v=O[0],x=O[1],y=Object(c.useState)(!1),k=Object(b.a)(y,2),w=k[0],C=k[1];document.querySelectorAll("img").forEach((function(e){return e.draggable=!1}));var E={display:j?"block":"none"},S=Object(c.useContext)(p).currentUser;m.auth().onAuthStateChanged((function(t){t&&(m.storage().ref("users/".concat(t.uid,"/profile.jpg")).getMetadata().then((function(e){"image/jpg"===e.contentType||"image/jpeg"===e.contentType||"image/png"===e.contentType?m.storage().ref("users/".concat(t.uid,"/profile.jpg")).getDownloadURL().then((function(e){s(e)})):s(N)})),e.getDataFromUser(e.uname))}));var I=function(){h((function(e){return!e}))};return Object(f.jsxs)("div",{className:"User",children:[Object(f.jsxs)("div",{className:"section1",id:"user",children:[Object(f.jsx)("img",{src:a,alt:"",unselectable:"on",className:"profileImages",onClick:I}),Object(f.jsxs)("span",{children:["Welcome ",e.uname]})]}),Object(f.jsx)("div",{className:"section2"}),Object(f.jsx)("div",{className:"uploadProfile",style:E,children:Object(f.jsxs)("div",{className:"userProfile_settings",children:[Object(f.jsx)("div",{children:"Click on your profile to go back"}),Object(f.jsx)("img",{src:a,alt:"",unselectable:"on",className:"settingsProfile",onClick:I}),Object(f.jsxs)("div",{className:"UserButtons updatePic",children:[Object(f.jsx)("i",{className:"far fa-user-circle"}),Object(f.jsxs)("div",{className:"updatePic_child",children:[Object(f.jsx)("label",{id:"PicInput_label",htmlFor:"PicInput",style:{display:w?"none":"block",cursor:"pointer"},children:"Select Profile Image"}),Object(f.jsx)("input",{type:"file",onChange:function(e){x(e.target.files[0]),C(!0)},id:"PicInput",accept:"image/*"}),Object(f.jsxs)("div",{className:"showChoiceButtons",style:{display:w?"block":"none"},children:[Object(f.jsx)("i",{className:"far fa-times-circle",id:"cancelUpload",onClick:function(){x(null),C(!1)}}),Object(f.jsx)("i",{className:"far fa-check-circle",id:"acceptUpload",onClick:function(){null!=v?(console.log("UPLOADING"),m.storage().ref("users/"+S.uid+"/profile.jpg").put(v).then((function(){l(!0),e.parentCallback(r)})),r&&l(!1),h(!1)):console.log("File is null"),C(!1)}})]})]})]}),Object(f.jsxs)("div",{className:"UserButtons signOut",children:[Object(f.jsx)("i",{className:"fas fa-power-off"}),Object(f.jsx)("div",{style:{minWidth:"11vw",background:"blue",textAlign:"center",padding:"1vh",cursor:"pointer"},onClick:function(){m.auth().signOut()},children:"Sign Out"})]})]})})]})},C=function(e){var t=Object(c.useState)({}),n=Object(b.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),i=Object(b.a)(o,2),r=i[0],l=i[1],j=Object(c.useState)(""),h=Object(b.a)(j,2),g=h[0],O=h[1],v=Object(c.useContext)(p).currentUser,x=function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(n),t.next=3,l(n);case 3:""!==g&&e.sendPicURL(g);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),N=function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getContactNameFromContacts(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),C=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,l(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),E=function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:O(n),e.sendPicURL(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),S=function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.getDataFromContacts(n);case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),I=function(){var t=Object(d.a)(u.a.mark((function t(n){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.getUserDataFromContacts(n);case 2:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();return Object(c.useEffect)((function(){try{m.database().ref().child("users").on("value",(function(e){null!=e.val()&&s(Object(y.a)({},e.val()))}))}catch(e){console.log(e)}}),[r]),Object(f.jsxs)("div",{className:"Contacts",children:[Object(f.jsx)("div",{children:Object.keys(a).filter((function(e){return a[e].uid===v.uid})).map((function(e){return Object(f.jsx)(w,{uid:v.uid,uname:a[e].uname,parentCallback:x,getDataFromUser:I},e)}))}),Object(f.jsxs)("div",{className:"searchBar",children:[Object(f.jsx)("div",{className:"div_search",children:Object(f.jsx)("i",{className:"fas fa-search"})}),Object(f.jsx)("input",{type:"text",id:"contactsBar",placeholder:"Search chats & groups"})]}),Object(f.jsx)("div",{id:"allContacts",children:Object.keys(a).filter((function(e){return a[e].uid!==v.uid})).map((function(e){return Object(f.jsx)(k,{uid:a[e].uid,uname:a[e].uname,sendBackData:C,updateImage:r,getClickedContact:S,getContactPic:E,getContactName:N,lastMessage:a[v.uid].contacts[a[e].uid]},e)}))})]})},E=n(53),S=(n(104),n(84)),I=n(81),P=n(82),D=n(52),U=n.n(D),B=null,M=function(e){var t=Object(c.useState)(null),n=Object(b.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),i=Object(b.a)(o,2),r=i[0],l=i[1],u=Object(c.useState)(""),d=Object(b.a)(u,2),j=d[0],m=d[1],h=Object(c.useState)(!1),g=Object(b.a)(h,2),O=g[0],v=g[1],x=Object(c.useState)(!1),y=Object(b.a)(x,2),N=y[0],k=y[1],w=Object(c.useState)(""),C=Object(b.a)(w,2),E=C[0],S=C[1],D=Object(c.useState)(""),M=Object(b.a)(D,2),L=M[0],R=M[1],A=Object(c.useContext)(p).currentUser,T=Object(c.useRef)(),_=Object(c.useRef)(),H=Object(c.useRef)(),V=Object(c.useRef)(),F=0,W=0,Y=0,q=0;function z(){document.onmouseup=null,document.onmousemove=null}function G(e){e.preventDefault(),F=Y-e.clientX,W=q-e.clientY,Y=e.clientX,q=e.clientY;var t=V.current;t.style.top=t.offsetTop-W+"px",t.style.left=t.offsetLeft-F+"px"}Object(c.useEffect)((function(){B=Object(P.io)("https://blabber-complete-server.herokuapp.com/"),navigator.mediaDevices.getUserMedia({audio:!0,video:{mandatory:{maxWidth:640,maxHeight:480}}}).then((function(e){s(e),T.current.srcObject=e})).catch((function(e){console.log("Permission to access video is denied")})),B.emit("whatDoYouWant"),B.on("gimmeYourDetails",(function(t){var n={name:e.name,uid:A.uid};B.emit("alreadySent",n),l(t)})),B.on("calluser",(function(e){var t=e.from,n=e.name,c=e.signal;m({isReceivedCall:!0,from:t,name:n,signal:c})}))}),[e,A,N]);return Object(f.jsxs)("div",{className:"VideoPlayer",ref:V,children:[Object(f.jsx)("div",{className:"windowClose",style:{display:O&&!N?"none":"block"},children:Object(f.jsx)("i",{className:"fas fa-window-close",onClick:function(){console.log("Clicking"),V.current.style.display="none"}})}),Object(f.jsx)("div",{id:"videoPlayer_topBar",onMouseDown:function(e){e.preventDefault(),Y=e.clientX,q=e.clientY,document.onmouseup=z,document.onmousemove=G},children:"Click to move"}),Object(f.jsxs)("div",{children:[a&&Object(f.jsx)("div",{id:"myVideoFrame",children:Object(f.jsx)("video",{playsInline:!0,muted:!0,ref:T,autoPlay:!0,id:"myVideo"})}),Object(f.jsx)("div",{id:"userVideoFrame",children:O&&!N&&Object(f.jsx)("video",{playsInline:!0,ref:_,autoPlay:!0,id:"userVideo"})})]}),Object(f.jsxs)("div",{className:"Options",children:[Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{children:[Object(f.jsx)("div",{children:"Copy your ID"}),Object(f.jsx)(I.CopyToClipboard,{text:r,children:Object(f.jsx)("i",{className:"far fa-clipboard",style:{marginTop:"20px"}})})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("input",{id:"input_special1",type:"text",value:L,onChange:function(e){return R(e.target.value)}}),O&&!N?Object(f.jsx)("i",{className:"fas fa-phone-slash",onClick:function(){H.current.destroy(),B.disconnect(),s(null),l(""),m(""),v(!1),k(!1),S(""),R(""),k(!0)}}):Object(f.jsx)("i",{className:"fas fa-phone",onClick:function(){return function(e){var t=new U.a({initiator:!0,trickle:!1,stream:a});t.on("signal",(function(t){B.emit("calluser",{userToCall:e,signalData:t,from:r,name:E})})),t.on("stream",(function(e){_.current.srcObject=e})),B.on("callaccepted",(function(e){v(!0),t.signal(e)})),H.current=t}(L)},id:"letsCall"})]})]}),Object(f.jsx)("div",{className:"Notifications",children:j.isReceivedCall&&!O&&Object(f.jsxs)("div",{styles:{display:"flex",justifyContent:"center"},children:[Object(f.jsxs)("h1",{children:[e.name," is calling"]}),Object(f.jsx)("button",{onClick:function(){v(!0),k(!1);var e=new U.a({initiator:!1,trickle:!1,stream:a});e.on("signal",(function(e){B.emit("answercall",{signal:e,to:j.from})})),e.on("stream",(function(e){_.current.srcObject=e})),e.signal(j.signal),H.current=e},children:"Answer"})]})})]})]})},L=function(e){var t=[],n=document.getElementById("gallery"),a=document.getElementById("drop-area"),s=document.getElementById("prev"),o=document.getElementById("next"),i=document.getElementsByClassName("mySlides")[0],r=[],l=Object(c.useState)([]),u=Object(b.a)(l,2),d=u[0],j=u[1],h=Object(c.useState)(!1),g=Object(b.a)(h,2),O=g[0],v=g[1],x=Object(c.useState)(!1),N=Object(b.a)(x,2),k=N[0],w=N[1],C=Object(c.useState)(!1),I=Object(b.a)(C,2),P=I[0],D=I[1],U=Object(c.useState)(""),B=Object(b.a)(U,2),L=B[0],R=B[1],A=Object(c.useState)(""),T=Object(b.a)(A,2),_=T[0],H=T[1],V=Object(c.useState)(""),F=Object(b.a)(V,2),W=F[0],Y=F[1],q=Object(c.useState)(!1),z=Object(b.a)(q,2),G=z[0],K=z[1],Q=Object(c.useContext)(p).currentUser,X=Object(c.useState)({}),J=Object(b.a)(X,2),Z=J[0],$=J[1],ee=Object(c.useState)(!1),te=Object(b.a)(ee,2),ne=te[0],ce=te[1],ae="fas fa-chevron-circle-down",se=Object(c.useState)(!1),oe=Object(b.a)(se,2),ie=oe[0],re=oe[1],le=Object(c.useState)(!1),ue=Object(b.a)(le,2),de=ue[0],je=ue[1],me=Object(c.useState)(!1),be=Object(b.a)(me,2),fe=be[0],pe=be[1],he="",ge=document.getElementsByClassName("inputMessage")[0];document.getElementsByClassName("messages")[0];["dragenter","dragover","dragleave","drop"].forEach((function(e){document.addEventListener(e,(function(e){e.preventDefault(),e.stopPropagation(),G&&(w(!1),a.style.display="none")}),!1)}));var Oe=function(e){e.preventDefault(),e.stopPropagation(),G&&"drop"!==e.type&&"dragleave"!==e.type&&w(!0)},ve=function(e){e.preventDefault(),e.stopPropagation(),G&&(w(!0),a.style.display="block",a.style.transform="translateY(-100%)",a.classList.add("highlight"))},xe=function(e){v(!0);var t=e.dataTransfer.files;r=Object(E.a)(t),w(!1),r.forEach((function(e){!function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){switch(e.type.split("/")[0]){case"image":var c=document.createElement("img");c.src=t.result,c.style.minWidth="120px",c.style.minHeight="120px",c.className="galleryChild",c.draggable=!1,n.appendChild(c);break;case"video":var a=document.createElement("video");a.src=t.result,a.style.minWidth="120px",a.style.minHeight="120px",a.autoplay=!1,a.controls=!1,a.className="galleryChild",n.appendChild(a);break;case"application":console.log(e.type.split("/")[1]);break;default:console.log("Unknown Type")}ye()}}(e)})),D(!0),r.length,j(Object(E.a)(r)),document.getElementById("uploadButton").disabled=!1};function ye(){null!==n&&(n.scrollWidth>n.offsetWidth?(s.style.display="block",o.style.display="block"):(s.style.display="none",o.style.display="none"),n.childNodes.forEach((function(e){e.onclick=function(){console.log("Length",r.length),console.log(e.tagName),"VIDEO"===e.tagName&&(e.controls=!0);var t=e.cloneNode(!0);i.childElementCount>0&&i.removeChild(i.childNodes[0]),i.appendChild(t),e.controls=!1}})))}window.addEventListener("resize",(function(){ye()}));var Ne=function(){if(0!==W.length){var t=new Date,n="".concat(t.getDate(),"-").concat(t.getMonth()+1,"-").concat(t.getFullYear()),c="".concat(t.getHours(),":").concat(t.getMinutes(),":").concat(t.getSeconds());m.database().ref("users/".concat(Q.uid,"/contacts/").concat(e.uid,"/messages")).push().set({date:n,time:c,message:W,uid:Q.uid}),m.database().ref("users/".concat(e.uid,"/contacts/").concat(Q.uid,"/messages")).push().set({date:n,time:c,message:W,uid:Q.uid}),m.database().ref("users/".concat(e.uid,"/contacts/").concat(Q.uid,"/lastMessage")).set({lastMessage:W}),m.database().ref("users/".concat(Q.uid,"/contacts/").concat(e.uid,"/lastMessage")).set({lastMessage:W}),ge.value="",Y("")}},ke=function(e){"LI"===e.target.tagName?e.target.childNodes[1].childNodes[0].className=ae:"SPAN"===e.target.tagName?void 0!==e.target.childNodes[1]?e.target.parentElement.childNodes[1].childNodes[0].className=ae:e.target.childNodes[0].className=ae:"DIV"===e.target.tagName&&"SPAN"===e.target.parentElement.nodeName?e.target.parentElement.parentElement.childNodes[1].childNodes[0].className=ae:"I"===e.target.tagName&&(e.target.className=ae)},we=function(e){"LI"===e.target.tagName?e.target.childNodes[1].childNodes[0].className="":"SPAN"===e.target.tagName?void 0!==e.target.childNodes[1]?e.target.parentElement.childNodes[1].childNodes[0].className="":e.target.childNodes[0].className="":"DIV"===e.target.tagName&&"SPAN"===e.target.parentElement.nodeName&&(e.target.parentElement.parentElement.childNodes[1].childNodes[0].className="")},Ce=function(t){if(t.target.className===ae){he=t.target.id,t.target.innerHTML="<section id='menuSection' style={{background:'#fff'}}>\n            <button id='edit'>Edit</button>\n            <button id='quote'>Quote</button>\n            <button id='copy'>Copy</button>\n            <button id='remove'>Remove</button>\n            </section>",re(!0);var n=document.getElementById("edit"),c=document.getElementById("quote"),a=document.getElementById("copy"),s=document.getElementById("remove");n.onclick=function(){console.log("Edit function")},c.onclick=function(){console.log("Quote function")},a.onclick=function(){var e=t.target.parentElement.parentElement.childNodes[0].childNodes[0].data,n=document.createElement("input");n.setAttribute("value",e),document.body.appendChild(n),n.select(),document.execCommand("copy"),document.body.removeChild(n)},s.onclick=function(){m.database().ref("users/".concat(Q.uid,"/contacts/").concat(e.uid,"/messages/").concat(he)).remove().then((function(){console.log("Data removed successfully")})).catch((function(e){console.log("Error in deleting data")})),m.database().ref("users/".concat(e.uid,"/contacts/").concat(Q.uid,"/messages/").concat(he)).remove().then((function(){console.log("Data removed successfully")})).catch((function(e){console.log("Error in deleting data")}))}}},Ee=function(e,t){if(e[t].message)return e[t].message;switch(e[t].type){case"audio":return Object(f.jsx)("audio",{src:e[t].file,controls:!0});case"image":return Object(f.jsx)("img",{src:e[t].file,alt:"",style:{width:"100px",height:"100px"}});case"video":return Object(f.jsx)("video",{src:e[t].file,style:{width:"360px",height:"240px"},controls:!0});default:console.log("Unaccepted file type",e[t].type)}};return Object(c.useEffect)((function(){""!==e.uid?(K(!0),R(e.uname),H(e.picLink),m.database().ref("users/".concat(Q.uid,"/contacts/").concat(e.uid,"/messages")).on("value",(function(e){$(Object(y.a)({},e.val()))}))):K(!1)}),[Q,e]),Object(f.jsxs)("div",{id:"god",onDrop:function(e){return Oe(e)},onDragOver:function(e){return Oe(e)},onDragEnter:function(e){return Oe(e)},onDragLeave:function(e){return Oe(e)},children:[Object(f.jsxs)("div",{className:"Chat",onClick:function(e){var t=document.querySelectorAll("i");ie&&(t.forEach((function(e){return e.innerHTML=""})),re(!1)),document.querySelectorAll(".fa-chevron-circle-down").forEach((function(e){return e.className=""}))},style:{display:k||O||P||0!==r.length?"none":"block"},children:[Object(f.jsx)("div",{className:"contactNotSelected",style:{display:G?"none":"block"},children:Object(f.jsxs)("h1",{children:["Hello ",e.user]})}),Object(f.jsxs)("div",{className:"userChat",style:{display:G?"block":"none"},children:[Object(f.jsxs)("div",{className:"chatName",children:[Object(f.jsx)("img",{className:"profileImages",src:_,alt:"Profile Pic"}),Object(f.jsx)("div",{className:"details",children:Object(f.jsx)("h2",{children:L})}),Object(f.jsx)("div",{className:"phoneCall",children:Object(f.jsx)("i",{className:"fas fa-phone"})}),Object(f.jsx)("div",{className:"videoCall",children:Object(f.jsx)("i",{className:"fas fa-video",onClick:function(){return pe(!0)}})})]}),Object(f.jsx)("div",{className:"div_messages",style:{height:ne?"47vh":"70vh"},children:Object(f.jsx)("ul",{className:"messages",children:Object.keys(Z).map((function(t,n){return Z[t].uid===e.uid?Object(f.jsxs)("li",{className:"thisIsNotUser",onMouseOver:ke,onMouseOut:we,children:[Object(f.jsxs)("span",{className:"msgSpan",children:[Ee(Z,t),Object(f.jsx)("div",{className:"time",children:Z[t].time})]}),Object(f.jsx)("span",{className:"space",style:{background:"rgba(0, 0, 0, 0)",width:"2vw",height:"4vh"},children:Object(f.jsx)("i",{className:"",id:t,onClick:Ce,style:{zIndex:"4 !important",position:"absolute",padding:0,float:"right"}})})]},t):Object(f.jsxs)("li",{className:"thisIsUser",onMouseOver:ke,onMouseOut:we,children:[Object(f.jsxs)("span",{className:"msgSpan",children:[Ee(Z,t),Object(f.jsx)("div",{className:"time",children:Z[t].time})]}),Object(f.jsx)("span",{className:"space",style:{background:"rgba(0, 0, 0, 0)",width:"2vw",height:"4vh"},children:Object(f.jsx)("i",{className:"",id:t,onClick:Ce,style:{zIndex:"4 !important",position:"absolute",padding:0,float:"right"}})})]},t)}))})}),Object(f.jsx)("div",{style:{background:"#000",height:ne?"23vh":"0vh"},children:ne&&Object(f.jsx)(S.a,{set:"twitter",onSelect:function(e){null==ge||(ge.value+=e.native),Y((function(t){return t+e.native})),ge.focus()}})}),Object(f.jsxs)("div",{className:"div_type_message",children:[Object(f.jsx)("div",{className:"emoji",onClick:function(){ce((function(e){return!e}))},children:Object(f.jsx)("i",{className:"far fa-laugh-beam"})}),Object(f.jsxs)("div",{className:"input_sendIcon_div",children:[Object(f.jsx)("input",{className:"inputMessage",type:"text",onKeyPress:function(e){"Enter"===e.key&&Ne()},onChange:function(e){Y(e.target.value)},autoComplete:"off",placeholder:"Type a message",autoFocus:!0}),Object(f.jsx)("i",{className:"fas fa-paper-plane",id:"sendIcon",onClick:Ne})]}),Object(f.jsxs)("div",{className:"voiceMessage",children:[Object(f.jsx)("i",{className:"fas fa-microphone-alt",onClick:function(){console.log("Recording Audio...");var n=!1;je(!0);navigator.mediaDevices.getUserMedia({audio:!0}).then((function(c){var a=document.getElementById("cancel"),s=document.getElementById("accept"),o=new MediaRecorder(c),i=[];t.push(o.stream),o.start(),console.log("Media Recorder",o.state),a.addEventListener("click",(function(e){"inactive"!==o.state&&o.stop(),je(!1)})),s.addEventListener("click",(function(e){"inactive"!==o.state&&o.stop(),je(!1),n=!0})),o.ondataavailable=function(e){i.push(e.data)},o.onstop=function(t){if(n){var c=new Blob(i,{type:"audio/mp3;"});i=[];var a=new Date,s="".concat(a.getDate(),"-").concat(a.getMonth()+1,"-").concat(a.getFullYear()),o="".concat(a.getHours(),"-").concat(a.getMinutes(),"-").concat(a.getSeconds());m.storage().ref("users/".concat(Q.uid,"/Audio")).child("".concat(s,"_").concat(o)).put(c).then((function(){m.storage().ref("users/".concat(Q.uid,"/Audio/").concat(s,"_").concat(o)).getDownloadURL().then((function(t){m.database().ref("users/".concat(Q.uid,"/contacts/").concat(e.uid,"/messages")).child("".concat(s,"_").concat(o)).set({date:s,time:o,message:null,file:t,uid:Q.uid,type:"audio"}).then((function(){console.log("Updated to db")})).catch((function(e){return console.log(e)}))}))}))}},console.log("Recorders",t)})).catch((function(e){console.log("Error")}))},style:{display:de?"none":"block"}}),Object(f.jsxs)("div",{style:{display:de?"block":"none"},className:"audio_div",children:[Object(f.jsx)("i",{className:"far fa-times-circle",id:"cancel"}),Object(f.jsx)("i",{className:"far fa-check-circle",id:"accept"})]})]})]})]})]}),Object(f.jsxs)("div",{id:"drag",style:{display:k||O?"block":"none"},onDragOver:function(e){return ve(e)},onDragEnter:function(e){return ve(e)},children:[Object(f.jsxs)("div",{className:"file_dropped",style:{visibility:P?"visible":"hidden"},children:[Object(f.jsxs)("div",{className:"slideshow-container",children:[Object(f.jsx)("div",{className:"mySlides fade"}),Object(f.jsx)("br",{})]}),Object(f.jsx)("input",{type:"file",id:"fileElem",multiple:!0,accept:"*"}),Object(f.jsxs)("div",{className:"galleryContainer",children:[Object(f.jsx)("span",{id:"prev",onClick:function(){n.prepend(n.removeChild(n.childNodes[n.childElementCount-1]))},children:"\u276e"}),Object(f.jsx)("div",{id:"gallery"}),Object(f.jsx)("span",{id:"next",onClick:function(){n.appendChild(n.removeChild(n.childNodes[0]))},children:"\u276f"})]}),Object(f.jsx)("i",{class:"fas fa-upload",onClick:function(){document.getElementById("uploadButton").disabled=!0,n.innerHTML="",document.getElementsByClassName("mySlides")[0].innerHTML="";var t=0,c=0;d.forEach((function(n){var a=new Date,s="".concat(a.getDate(),"-").concat(a.getMonth()+1,"-").concat(a.getFullYear()),o="".concat(a.getHours(),"-").concat(a.getMinutes(),"-").concat(a.getSeconds()),i=n.type.split("/")[0],r="";switch(i){case"image":r="Images";break;case"video":r="Video";break;case"application":r="Application";break;case"audio":r="Audio";break;default:r="Default"}m.storage().ref("users/".concat(Q.uid,"/").concat(r)).child("".concat(s,"_").concat(o,"_").concat(t)).put(n).then((function(){console.log("Uploaded","".concat(s,"_").concat(o,"_").concat(t)),++c===d.length&&function(t,n,c,a,s){for(var o=function(c){m.storage().ref("users/".concat(Q.uid,"/").concat(a,"/").concat(t,"_").concat(n,"_").concat(c)).getDownloadURL().then((function(a){m.database().ref("users/".concat(Q.uid,"/contacts/").concat(e.uid,"/messages")).child("".concat(t,"_").concat(n,"_").concat(c)).set({date:t,time:n,message:null,file:a,uid:Q.uid,type:s}).then((function(){m.database().ref("users/".concat(e.uid,"/contacts/").concat(Q.uid,"/messages")).child("".concat(t,"_").concat(n,"_").concat(c)).set({date:t,time:n,message:null,file:a,uid:Q.uid,type:s})}))})).catch((function(e){return console.log(e)}))},i=0;i<c;i++)o(i)}(s,o,d.length,r,i)})).catch((function(e){console.log(e)})),++t})),j([]),D(!1),v(!1),s.style.display="none",o.style.display="none",console.log("OUT")},id:"uploadButton"})]}),Object(f.jsx)("div",{id:"drop-area",style:{display:k?"block":"none"},onDragLeave:function(e){return a.classList.remove("highlight"),w(!1),void(a.style.display="none")},onDrop:function(e){return xe(e)}})]}),Object(f.jsx)("div",{children:fe&&Object(f.jsx)(M,{name:e.user})})]})},R=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(""),o=Object(b.a)(s,2),i=o[0],r=o[1],l=Object(c.useState)(""),j=Object(b.a)(l,2),m=j[0],p=j[1],h=Object(c.useState)(""),g=Object(b.a)(h,2),O=g[0],v=g[1],x=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,a(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r(t);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),N=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(d.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(f.jsx)("div",{className:"Main",children:Object(f.jsxs)("div",{className:"chatSection",children:[Object(f.jsx)(C,{getDataFromContacts:x,sendPicURL:N,getContactNameFromContacts:y,getUserDataFromContacts:k}),Object(f.jsx)(L,{uid:n,uname:i,picLink:m,user:O})]})})},A=n(83),T=function(e){var t=e.component,n=Object(A.a)(e,["component"]),a=Object(c.useContext)(p).currentUser;return Object(f.jsx)(r.b,Object(y.a)(Object(y.a)({},n),{},{render:function(e){return a?Object(f.jsx)(t,Object(y.a)({},e)):Object(f.jsx)(r.a,{to:"/login"})}}))},_=function(){var e=Object(c.useState)(""),t=Object(b.a)(e,2),n=t[0],a=t[1],s=Object(c.useState)(!1),o=Object(b.a)(s,2),i=o[0],r=o[1];Object(c.useEffect)((function(){}),[i]);return Object(f.jsxs)("div",{className:"ManageUser",children:[Object(f.jsx)("div",{style:{display:i?"none":"block"},children:Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m.auth().sendPasswordResetEmail(n).then((function(){console.log("Password Reset Email send")})).catch((function(e){console.log("Error:",e)})),r(!0),a("")},children:[Object(f.jsx)("input",{type:"email",value:n,placeholder:"Enter your email",onChange:function(e){return a(e.target.value)}}),Object(f.jsx)("button",{className:"uiButtons",type:"submit",children:"Reset"})]})}),Object(f.jsx)("div",{style:{display:i?"block":"none",color:"white"},children:"Check your email for password reset link"})]})},H=function(e){var t=Object(c.useState)(!1),n=Object(b.a)(t,2),a=n[0],s=n[1],o=Object(c.useState)(""),i=Object(b.a)(o,2),l=i[0],u=i[1],d=Object(c.useState)(""),j=Object(b.a)(d,2),p=j[0],h=j[1],g=Object(c.useState)(!1),O=Object(b.a)(g,2),v=O[0],x=O[1],y=Object(c.useState)(!1),N=Object(b.a)(y,2),k=N[0],w=N[1],C=Object(c.useState)(!1),E=Object(b.a)(C,2),S=E[0],I=E[1],P=Object(c.useState)(!1),D=Object(b.a)(P,2),U=D[0],B=D[1],M=Object(c.useState)(""),L=Object(b.a)(M,2),R=L[0],A=L[1],T=Object(c.useState)(""),_=Object(b.a)(T,2),H=_[0],V=_[1],F=Object(c.useState)(!1),W=Object(b.a)(F,2),Y=W[0],q=W[1],z=Object(c.useState)(""),G=Object(b.a)(z,2),K=G[0],Q=G[1];m.auth().onAuthStateChanged((function(e){s(null!==e&&e.emailVerified)}));var X=function(e){var t=window.location.href;e=e.replace(/[\][\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?decodeURIComponent(n[2].replace(/\+/g," ")):null};return Object(c.useEffect)((function(){if(console.log("MANAGE USER"),void 0===e.location.type){var t=X("mode"),n=X("oobCode");if(null!==t&&null!==n)switch(A(n),t){case"verifyEmail":m.auth().applyActionCode(n).then((function(e){console.log(e),console.log("Verified"),s(!0)})).catch((function(e){return console.log("Error In Email Verification",e)}));break;case"resetPassword":m.auth().verifyPasswordResetCode(n).then((function(e){B(!0)})).catch((function(e){console.log("Password Reset Error")}));break;default:console.log("Error in Action")}else null===t&&null===n&&q(!0)}else null!==m.auth().currentUser?!1===m.auth().currentUser.emailVerified?x(!0):x(!1):x(!0);return function(){t="",n=""}}),[a,Y,e,v]),Object(f.jsxs)("div",{className:"ManageUser",children:[Object(f.jsx)("div",{className:"verifyEmail",style:{display:Y?"block":"none"},children:a?Object(f.jsx)(r.a,{to:"/login"}):Object(f.jsx)("div",{children:Object(f.jsx)("h1",{style:{color:"white"},children:"Verify your email!!!"})})}),Object(f.jsx)("div",{className:"ManageUser",style:{display:U?"block":"none"},children:S?Object(f.jsx)(r.a,{to:"/login"}):Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),l===p?m.auth().confirmPasswordReset(R,l).then((function(){console.log("Password Set Successfully"),I(!0)})).catch((function(e){return console.log("Password Reset Error: ",e)})):console.log("Passwords don't match")},children:[Object(f.jsx)("input",{type:"password",value:l,placeholder:"Enter new password",onChange:function(e){return u(e.target.value)}}),Object(f.jsx)("input",{type:"password",value:p,placeholder:"Re-enter new password",onChange:function(e){return h(e.target.value)}}),Object(f.jsx)("button",{className:"uiButtons",type:"submit",children:"Set"})]})}),Object(f.jsxs)("div",{className:"sendResetLink",style:{display:v?"block":"none"},children:[Object(f.jsx)("div",{style:{display:k?"none":"block"},className:"passwordResetForm_parent",children:Object(f.jsxs)("form",{onSubmit:function(e){e.preventDefault(),m.auth().sendPasswordResetEmail(H).then((function(){console.log("Password Reset Email send"),Q("Check your email for the password reset link")})).catch((function(e){"auth/user-not-found"===e.code?Q("There is no user record corresponding to this email."):Q("There is an error related to the submitted credentials")})),w(!0),V("")},children:[Object(f.jsx)("div",{children:"RESET PASSWORD"}),Object(f.jsx)("input",{type:"email",value:H,placeholder:"Enter your email",onChange:function(e){return V(e.target.value)}}),Object(f.jsx)("button",{className:"uiButtons",type:"submit",children:"Reset"})]})}),Object(f.jsx)("div",{style:{display:k?"block":"none",color:"white"},children:K})]})]})};var V=function(){return document.querySelectorAll("img").forEach((function(e){return e.draggable=!1})),Object(f.jsx)(h,{children:Object(f.jsx)(i.a,{children:Object(f.jsx)("div",{className:"App",children:Object(f.jsxs)(r.d,{children:[Object(f.jsx)(r.b,{path:"/",exact:!0,component:x}),Object(f.jsx)(r.b,{path:"/login",component:O}),Object(f.jsx)(r.b,{path:"/signup",component:v}),Object(f.jsx)(r.b,{path:"/manage-user",component:H}),Object(f.jsx)(r.b,{path:"/reset-password",component:_}),Object(f.jsx)(T,{path:"/main",component:R})]})})})})};o.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(V,{})}),document.getElementById("root"))},44:function(e,t,n){},54:function(e,t,n){},89:function(e,t,n){}},[[147,1,2]]]);
//# sourceMappingURL=main.e9697a42.chunk.js.map